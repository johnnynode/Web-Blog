### Python中的urllib介绍

- 在Python2中, 有`urllib`与`urllib2`两个库可以用来实现request的发送
- 而在Python3中, 没有`urllib2`了，统一称为：`urllib`
- `urllib`中包括了四个模块：
    * `urllib.request`: 可以用来发送request和获取request的结果
    * `urllib.error`: 包含了urllib.request产生的异常
    * `urllib.parse`: 用于解析和处理URL
    * `urllib.robotparse`: 用于解析页面的robots.txt文件

### 关于urllib.request模块

- 该模块提供了最基本的构造HTTP请求的方法, 可以模拟浏览器的请求过程，同时还带有处理authentication(授权验证)、redirections(重定向)、cookies(浏览器Cookies)等内容
- 使用示例：`urllib.request.urlopen(url, data=None, [timeout,]*, cafile=None, capath=None, cadefault=False, context=None)`
    * 参数：url是地址；data：可选附加参数，字节流编码格式(bytes()可转换), 请求方式会变为POST; timeout(超时时间)单位为秒, 未及时响应则抛出异常
    * 返回：HTTPResponse类型的对象：`response.read()` 可得到返回的网页内容, 可使用decode('utf-8')解码字符串； `response.status` 可以得到返回结果的状态码


### 关于urllib.request.Request模块

- 利用`urlopen()`可实现最基本的请求发起，但不足以构建一个完整的请求
- 使用强大的`Request`类可以在请求中加入需要的`headers`等信息
    * 示例源码：`class urllib.request.Request(url,data=None,headers={},origin_req_host=None,unverifiable=False,method=None)`
    * 参数`url`: 是必传参数，其他都是可选参数
    * 参数`data`: 参数如果要传必须传bytes(字节流)类型的, 如果是一个字典, 可以先用urllib.parse.urlencode()进行编码
    * 参数`headers`: 是一个字典, 可在构造Request时通过headers参数传递，也可通过调用`add_header()`来添加请求头
    * 参数`origin_req_host`: 请求方的host名称或IP地址
    * 参数`unverifiable` 指的是这个请求是否是无法验证的，默认是`False`, 意思是用户没有足够权限来选择接受这个请求的结果
    * 参数`method`是一个字符串，用来指示请求使用的方法，如：`GET`、`POST`、`PUT`等

### 使用urllib模块来爬取数据示例

```python
import urllib.request
import re

url = "http://www.baidu.com"
res = urllib.request.urlopen(url)
# print(res.read().decode("utf-8")) # 请求的结果是html代码
# print(len(res.read())) # 153682 注：此处输出网页字符的长度
html = res.read().decode("utf-8")

dlist = re.findall("<title>(.*?)</title>", html)
print(dlist) # ['百度一下，你就知道']
```